<!doctype html>
<html>

<script>
  /**************************************************
 * WELCOME to the Index
 **************************************************/
/**************************************************
 * AUSTIN TRAFFIC INCIDENTS
 * by
 * Jason Bartling
 * Ian Kelly
 * Brandon Rose
 **************************************************/
                                              </script>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">

  <script>
    /**************************************************
   * Apply MOBILE optimization metadata
   **************************************************/
  </script>

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Austin Traffic">
  <link rel="apple-touch-icon" href="./img/touch-icon-iphone.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./img/favicon-16x16.png">

  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-640x1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-750x1294.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-1242x2148.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-1536x2048.png" media="(min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-1668x2224.png" media="(min-device-width: 834px) and (max-device-width: 834px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="./img/splash/launch-2048x2732.png" media="(min-device-width: 1024px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)">
  <title>Austin Traffic Incidents</title>

  <script>
    /**************************************************
   * LOAD STYLESHEETS
   * Beauty, W3, ESRI, Google Fonts, Font Awesome
   **************************************************/
  </script>

  <link rel="stylesheet" href="https://js.arcgis.com/4.9/esri/css/main.css">
  <link id="pagestyle" rel="stylesheet" type="text/css" href="beauty.css">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link id="darkTheme" rel="stylesheet"> <!-- empty style to be filled with dark on JS -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script>
    /**************************************************
   * LOAD JAVASCRIPT
   * Mapping, ESRI, Tippy JS
   * Animate loads at end of body
   **************************************************/
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.js"></script>
  <script src="https://js.arcgis.com/4.9/"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
  <script src="mapping.js"></script>
  <script src="https://unpkg.com/tippy.js@3/dist/tippy.all.min.js"></script>


</head>

<body onload="checkCookie()" id="entireApp">

  <span id="activitySpinner" class="fa fa-spinner fa-pulse"></span>

  <script>
    /**************************************************
   * Create custom widget buttons on map for
   *   settings and info
   **************************************************/
  </script>

  <div id="infoButton" class="esri-icon-description" aria-label="close icon" onclick="openOverlay()"></div>

  <div id="settingsButton" class="esri-icon-settings" aria-label="settings icon" onclick="toggleSettings()"></div>

  <div id="settingsCover" onclick="closeSettings()"></div>

  <script>
    /**************************************************
   * Create main toolbox div
   **************************************************/
  </script>

  <div id="toolBox">

    <div id="boxHeader" onclick="openOverlay()">
      <img id="lightModeLogo" src="./img/logoBlack.png" alt="awheel logo">
      <img id="darkModeLogo" src="./img/logoGrey.png" alt="awheel logo">
      <h2>Austin Traffic Incidents</h2>
      <span id="headerInfo" class="esri-icon-description" aria-label="info icon"></span>
    </div>

    <script>
      /**************************************************
     * Create tabbed MENU, assign function to click
     **************************************************/
    </script>

    <div id="boxMenu">
      <div class="w3-row">
        <a href="javascript:void(0)" onclick="openMenu(event, 'Legend')" id="legendTab">
          <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding">Legend</div>
        </a>
        <a href="javascript:void(0)" onclick="openMenu(event, 'Search')">
          <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding">Search</div>
        </a>
        <a href="javascript:void(0)" onclick="openMenu(event, 'Locate')">
          <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding">Locate</div>
        </a>
      </div>
    </div>

    <script>
      /**************************************************
     * Create BOXCONTENT div, assign functions to close on click
     **************************************************/
    </script>

    <div id="boxContent" style="display:none">

      <script>
        /**************************************************
       * Create LEGEND div
       **************************************************/
      </script>

      <div id="Legend" class="w3-container title">
        <span onclick="closeMenu(event, 'Legend')" class="esri-icon-up" aria-label="close icon" id="legendClose"></span>

        <br>
        <div id="esriLegend"></div>
        <input type="button" id="resetData" value="Active Incidents"><br>
        <span id="legendInfo" data-tippy="Use the legend tool for descriptions of the symbols visible on the map." class="esri-icon-description" aria-label="info icon"></span>

        <canvas id="myChart" width="400" height="400" aria-label="Incident Doughnut Chart" role="img"></canvas>




        <span id="legendSpinner" class="esri-icon-refresh" aria-label="refresh icon" onclick="refreshPage()"></span>

        <p id="locateResult"><span onclick="toggleTable()" id="bufferResults">Total:</span>

      </div>

      <script>
        /**************************************************
       * Create SEARCH div
       **************************************************/
      </script>

      <div id="Search" class="w3-container title" style="display:none">
        <span onclick="closeMenu(event, 'Search')" class="esri-icon-up" aria-label="close icon" id="searchClose"></span>
        <div id="searchOptions">
          <div id="leftSearch">
            <br>
            <label for="daysFromDate">Enter Days from Current Date:</label><br>
            <input type="text" id="daysFromDate" maxlength="3" placeholder="Between 1 and 365">
            <br>
            <br>
            <label for="incidentTypes">Select up to 5 Incident Types:</label>
            <br>
            <select id="incidentTypes" multiple></select>
          </div>
          <br>
          <div id="rightSearch">
            <span>&nbsp;&nbsp;Display:</span>
            <br>
            <form id="renderToggle">
              <label><input id="buttonPoints" type="radio" name="searchT" value="points" checked> Points &nbsp;&nbsp;</label>
              <label><input id="buttonHeatmap" type="radio" name="searchT" value="heatmap"> Heatmap<br></label>
            </form>
            <br>
            <input type="submit" id="submitButton" value="Submit"><br>


            <p>Matched Incidents: <span id="numRecords"></span></p>
          </div>
        </div>

        <span id="searchInfo" data-tippy="Use search to display locations for individual incident types, group incidents by user preference, and to generate a heat map based on the found data." class="esri-icon-description" aria-label="info icon"></span>
        <span id="searchSpinner" class="esri-icon-refresh" aria-label="refresh icon" onclick="refreshPage()"></span>
      </div>

      <script>
        /**************************************************
       * Create LOCATE div
       **************************************************/
      </script>

      <div id="Locate" class="w3-container title" style="display:none">
        <span onclick="closeMenu(event, 'Locate')" class="esri-icon-up" aria-label="close icon" id="locateClose"></span>

        <span id="searchLabel">Enter an Address:</span>
        <div id="esriLocate"></div>
        <p id="radiusOptions">
          <label for="bufferRadius">Choose Circle Radius: </label>
          <select id="bufferRadius">
            <option value=1>1 mile</option>
            <option value=2>2 miles</option>
            <option value=3>3 miles</option>
            <option value=4>4 miles</option>
          </select>
        </p>

        <span id="locateSpinner" class="esri-icon-refresh" aria-label="refresh icon" onclick="refreshPage()"></span>
        <span id="locateInfo" data-tippy="Use the locate tool to search by your current location or enter an address manually to see all incidents within a 1-mile radius." class="esri-icon-description" aria-label="info icon"></span>
        <span id="resultsLabel">View Results:</span>

        <span id="chartLabel">Chart</span>
        <span onclick="toggleTable()" class="fa fa-table" id="tableIcon"></span>
        <span id="tableLabel">Table</span>
        <span onclick="openLegend()" class="fa fa-pie-chart" id="chartIcon"></span>
      </div>
    </div>
  </div>



  <script>
    /**************************************************
     * Create full overlay, assign function to icon
     **************************************************/
  </script>

  <div id="fullOverlay" class="overlay">
    <a href="javascript:void(0)" onclick="closeOverlay()" class="esri-icon-close" aria-label="close icon" id="closeOverlay"></a>

    <div class="overlay-content">

      <script>
        /**************************************************
         * Create overlay navigation, assign functions to click
         * Switch between team info and project info
         **************************************************/
      </script>

      <div id="aboutNav">
        <button id="aboutButtons" class="buttons" onclick="teamOverlay()">About Team</button>
        <button id="aboutButtons" class="buttons" onclick="projectOverlay()">About Project</button>
      </div>

      <script>
        /**************************************************
         * Information about team members
         * Name, picture, about
         **************************************************/
      </script>

      <div id="overlayTeam">
        <div class="about">
          <h3>Jason Bartling</h3>
          <img src="./img/biojason.jpg">
          <p>
            My name is Jason Bartling, and I live in San Marcos, TX. I'm a GIS major at Texas State University.
            It's great to finally be graduating this December! Some things I enjoy are movies, music, and books.
            In my spare time I've been trying to polish up on my Python programming skills and my drone piloting ability.
          </p>
        </div>
        <div class="about">
          <h3>Ian Kelly</h3>
          <img src="./img/bioian.jpg">
          <p>
            I am a graduating senior GIS major. This is my first time coding but I enjoyed the difficult lessons and look forward to the final capstone project. I enjoy hiking and camping having recently visited Zion NP in Utah and look forward to
            an upcoming trip to Big Bend. The drone pictured was used in a UAS mapping project with Dr. Jensen.
          </p>
        </div>
        <div class="about">
          <h3>Brandon Rose</h3>
          <img src="./img/biobrandon.jpg">
          <p>
            Currently I am a Graduate Student working toward my Masters of Geography at Texas State University. I graduated from Texas State with a bachelors in GIS and a minor in Computer Science in 2017. My areas of interest are Remote
            Sensing/GIS, Geovisualisation, and Physical Geography. Like my team members I also operate sUAS’s for both mapping and as a hobby.
          </p>
        </div>
        <br>
        <br>
        <br>
      </div>

      <script>
        /**************************************************
         * Information about project
         **************************************************/
      </script>

      <div id="overlayProject">
        <h2>Austin Traffic Incidents</h2>
        <br>
        <h3 id="byLine">A project to map and visualize traffic incidents in
          Austin, TX</h3>
        <br>
        <p><i>Austin Traffic Incidents</i> is a web interface for displaying
          historic traffic incidents with multiple temporal scales, a query
          function to search by incident type, a geocoder to search by an
          address, and a heat map showing the areas of greatest concentration
          of incidents. On initial load the application displays active
          incidents grouped by predefined classes; Crash, Hazard, and Advisory.
          These classes give a general idea of incident severity
          which helps give the user a quick summary of incident information for
          the city. The UI provides an area to access the specific functions of
          the application. First is the Legend tab; here a legend is
          provided which updates as the user interacts with the data.
          Second is the Search tab; here the user queries the data by
          indicating a date range of previous incidents as related to the date
          accessing, selecting 5 incident types for visualizing, selecting how
          to display the results, and finally executes by clicking submit.
          Lastly is the Locate tab; here the user selects a buffer
          radius and inputs an address, results are a buffer
          containing incidents within the user selected range symbolized by
          predefined classes. Users are also provided with an option to
          generate a chart or table for detailed information about the area
          specified.
          <br>
          <br>
          <h3>Incident Classes as defined for <i>Ausitn Traffic Incidents</i><h3>
          <h3 id="crash">Crash</h3>
          <p>AUTO/ PED,
            BOAT ACCIDENT,
            COLLISION,
            COLLISION/PRIVATE PROPERTY,
            COLLISION WITH INJURY,
            COLLISN / FTSRA,
            COLLISN/ LVNG SCN,
            Crash Service,
            Crash Urgent,
            FLEET ACC/ INJURY,
            TRAFFIC FATALITY</p>
          <h3 id="hazard">Hazard</h3>
          <p>Traffic Hazard,
            Traffic Impediment,
            TRFC HAZD/ DEBRIS,
            HIGH WATER,
            ICY ROADWAY</p>
          <h3 id="advisory">Advisory</h3>
          <p>BLOCKED DRIV/ HWY,
            LOOSE LIVESTOCK,
            N / HZRD TRFC VIOL,
            VEHICLE FIRE,
            zSTALLED VEHICLE</p>
          <h3>Links</h3>
          <p id="aboutLinks">
            <a href="https://github.com/atym/awheelTraffic" target="_blank">GitHub Repo for <i>Austin Traffic Incidents</i></a>
            <br>
            <a href="https://data.austintexas.gov/Transportation-and-Mobility/Real-Time-Traffic-Incident-Reports/dx9v-zd7x" target="_blank">Real-Time Traffic Incident Reports from The City of Austin</a>
            <br>
            <a href="https://developers.arcgis.com/javascript/" target="_blank">ArcGIS API for JavaScript</a>
            <br>
            <a href="https://developer.here.com/documentation/map-tile/topics/traffic-tiles.html" target="_blank">HERE Map Tile API</a>
            <br>
            <a href="https://www.chartjs.org/" target="_blank">Chart.js - Simple yet flexible JavaScript charting for designers & developers</a>
            <br>
            <a href="https://atomiks.github.io/tippyjs/" target="_blank">Tippy.js - A highly customizable vanilla JS tooltip & popover library</a>
          </p>
          <br>
          <br>
          <h3>Appendix</h3>
          <p>Jason Bartling: Data load queries, Search tool, Locate tool, Loading spinner implementation, Map reset and zoom
            <br>
            <br>
            Ian Kelly: HTML, CSS, and animation JS, Chart, Table, and Live traffic layer
            <br>
            <br>
            Brandon Rose: Initial data display, Data visualization, Legend,	Class, Heatmap, and Incident type renderers

          </p>
          <br>
          <br>
          <br>
      </div>
    </div>
  </div>

  <script>
    /**************************************************
   * Create popup box to store settings
   **************************************************/
  </script>

  <div id="settingsDiv" class="box">

    <span class="esri-icon-close" id="closeSettings" onclick="closeSettings()"></span>

    <label><input type="checkbox" id="currentTraffic"> Traffic</label>
    <br>
    <label><input type="checkbox" id="darkMode" onclick="swapStyleSheet('black.css')"> Dark Mode</label>
    <br>
    <label><input type="checkbox" id="cityLimitsLayer"> City Limits</label>
    <br>
    <label><input type="checkbox" id="scaleBar"> Scalebar</label>

  </div>

  <div id="expandWidget"></div>



  <table id="table">
    <tr>
      <th>Incident</th>
      <th>#</th>

    </tr>
    <tr>
      <td>Matched in <span id="totalTable"></span> mile radius:</td>
      <td id="totalLocate"></td>

    </tr>
    <tr>
      <td></td>
      <td></td>

    </tr>
    <tr id="autoPedTab">
      <td>AUTO/ PED</td>
      <td id="totalAutoPed"></td>

    </tr>
    <tr id="blockDriveTab">
      <td>BLOCKED DRIV/ HWY</td>
      <td id="totalBlockDrive"></td>

    </tr>
    <tr id="boatCrashTab">
      <td>BOAT ACCIDENT</td>
      <td id="totalBoat"></td>

    </tr>
    <tr id="collisionTab">
      <td>COLLISION</td>
      <td id="totalCollision"></td>

    </tr>
    <tr id="privatePropertyTab">
      <td>COLLISION/PRIVATE PROPERTY</td>
      <td id="totalPrivate"></td>

    </tr>
    <tr id="collisionInjuryTab">
      <td>COLLISION WITH INJURY</td>
      <td id="totalInjury"></td>

    </tr>
    <tr id="ftsraTab">
      <td>COLLISN / FTSRA</td>
      <td id="totalFtsra"></td>

    </tr>
    <tr id="leaveSceneTab">
      <td>COLLISN/ LVNG SCN</td>
      <td id="totalLeave"></td>

    </tr>
    <tr id="crashServiceTab">
      <td>Crash Service</td>
      <td id="totalService"></td>

    </tr>
    <tr id="crashUrgentTab">
      <td>Crash Urgent</td>
      <td id="totalUrgent"></td>

    </tr>
    <tr id="fleetACCTab">
      <td>FLEET ACC/ INJURY</td>
      <td id="totalFleet"></td>

    </tr>
    <tr id="highWaterTab">
      <td>HIGH WATER</td>
      <td id="totalWater"></td>

    </tr>
    <tr id="icyRoadwayTab">
      <td>ICY ROADWAY</td>
      <td id="totalIce"></td>

    </tr>
    <tr id="looseLivestockTab">
      <td>LOOSE LIVESTOCK</td>
      <td id="totalLivestock"></td>

    </tr>
    <tr id="nHZRDTab">
      <td>N / HZRD TRFC VIOL</td>
      <td id="totalNonHzrd"></td>

    </tr>
    <tr id="trafficFatalityTab">
      <td>TRAFFIC FATALITY</td>
      <td id="totalFatal"></td>

    </tr>
    <tr id="trafficHazardTab">
      <td>Traffic Hazard</td>
      <td id="totalHazard"></td>

    </tr>
    <tr id="trafficImpedimentTab">
      <td>Traffic Impediment</td>
      <td id="totalImpediment"></td>

    </tr>
    <tr id="trafficDebrisTab">
      <td>TRFC HAZD/ DEBRIS</td>
      <td id="totalDebris"></td>

    </tr>
    <tr id="vehicleFireTab">
      <td>VEHICLE FIRE</td>
      <td id="totalFire"></td>

    </tr>
    <tr id="stalledVehicleTab">
      <td>zSTALLED VEHICLE</td>
      <td id="totalStall"></td>

    </tr>

  </table>

  <span id="tableClose" class="esri-icon-left" aria-label="close table" onclick="closeTable()"></span>

  <script>
    /**************************************************
     * Footer info div
     **************************************************/
  </script>

  <div id="lightFooter">&copy; awheel Intelligence 2018 <span>Texas State University</span></div>
  <div id="darkFooter">&copy; awheel Intelligence 2018 <span>Texas State University</span></div>

  <script>
    /**************************************************
     * Create view for map to load into
     **************************************************/
  </script>

  <div id="viewDiv"></div>




  <script>
    /**************************************************
     * Load animate file after HTML body built
     **************************************************/
  </script>

  <script src="animate.js"></script>

</body>

</html>
